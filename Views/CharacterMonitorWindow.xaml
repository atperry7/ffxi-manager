<Window x:Class="FFXIManager.Views.CharacterMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FFXI Characters" Height="300" Width="180"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="150" MinWidth="180">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Compact Header -->
        <Border Grid.Row="0" Background="#34495E" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="ðŸŽ®" Foreground="White" FontSize="12" VerticalAlignment="Center" Margin="0,0,3,0"/>
                    <TextBlock Text="{Binding CharacterCount}" Foreground="White" FontWeight="Bold" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock Text=" chars" Foreground="LightGray" FontSize="10" VerticalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <ToggleButton x:Name="AlwaysOnTopToggle" 
                                  Content="ðŸ“Œ" 
                                  ToolTip="Always On Top"
                                  Style="{StaticResource IconToggleButton}"
                                  Width="20" Height="20" 
                                  FontSize="9"
                                  Margin="0,0,2,0"
                                  Checked="AlwaysOnTopToggle_Checked"
                                  Unchecked="AlwaysOnTopToggle_Unchecked"/>
                    
                    <Button Content="âŒ" 
                            Click="CloseButton_Click"
                            ToolTip="Close"
                            Style="{StaticResource DangerIconButton}"
                            Width="20" Height="20"
                            FontSize="9"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Compact Character List -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <ItemsControl ItemsSource="{Binding Characters}" Margin="3">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border BorderBrush="LightGray" BorderThickness="1" Margin="0,0,0,2" Padding="3" CornerRadius="2">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Background" Value="White"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                                            <Setter Property="Background" Value="#E3F2FD"/>
                                            <Setter Property="BorderBrush" Value="#2196F3"/>
                                            <Setter Property="BorderThickness" Value="2"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsResponding}" Value="False">
                                            <Setter Property="Background" Value="#FFEBEE"/>
                                            <Setter Property="BorderBrush" Value="#F44336"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Character Name - Compact -->
                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                    <Ellipse Width="6" Height="6" 
                                             Fill="{Binding StatusColor}" 
                                             VerticalAlignment="Center" Margin="0,0,3,0"/>
                                    <TextBlock Text="{Binding DisplayName}" 
                                               FontWeight="Bold" FontSize="10" 
                                               TextTrimming="CharacterEllipsis"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Compact Activate Button -->
                                <Button Grid.Row="1" 
                                        Margin="0,2,0,0"
                                        FontSize="9"
                                        Height="18"
                                        HorizontalAlignment="Stretch"
                                        Command="{Binding DataContext.ActivateCharacterCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        CommandParameter="{Binding}">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource ModernButtonBase}">
                                            <Setter Property="Content" Value="ðŸŽ¯ Switch"/>
                                            <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
                                            <Setter Property="Padding" Value="2"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="Content" Value="âœ“ Active"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding IsResponding}" Value="False">
                                                    <Setter Property="Background" Value="{StaticResource DangerBrush}"/>
                                                    <Setter Property="Content" Value="âš ï¸ Dead"/>
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource SuccessHoverBrush}"/>
                                                </Trigger>
                                                <MultiTrigger>
                                                    <MultiTrigger.Conditions>
                                                        <Condition Property="IsMouseOver" Value="True"/>
                                                        <Condition Binding="{Binding IsActive}" Value="True"/>
                                                    </MultiTrigger.Conditions>
                                                    <Setter Property="Background" Value="{StaticResource PrimaryHoverBrush}"/>
                                                </MultiTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        
        <!-- No Characters Message - Compact -->
        <Border Grid.Row="1" 
                Background="#F8F9FA" 
                Margin="5"
                Padding="10">
            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding CharacterCount}" Value="0">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="ðŸŽ®" FontSize="24" HorizontalAlignment="Center" Opacity="0.5"/>
                <TextBlock Text="No characters" 
                           FontSize="10" FontWeight="Bold" 
                           HorizontalAlignment="Center" Margin="0,5,0,2"/>
                <TextBlock Text="Launch FFXI"
                           FontSize="9" Foreground="Gray"
                           HorizontalAlignment="Center" 
                           TextWrapping="Wrap" 
                           TextAlignment="Center"/>
            </StackPanel>
        </Border>
        
        <!-- Compact Footer Controls -->
        <Border Grid.Row="2" Background="#2C3E50" Padding="3">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <ToggleButton Grid.Column="0" 
                              IsChecked="{Binding IsMonitoring}"
                              Width="16" Height="16" 
                              ToolTip="Toggle Monitoring"
                              FontSize="8">
                    <ToggleButton.Style>
                        <Style TargetType="ToggleButton" BasedOn="{StaticResource IconToggleButton}">
                            <Setter Property="Content" Value="â¸"/>
                            <Style.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Content" Value="â–¶"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>
                
                <TextBlock Grid.Column="1" 
                           Text="{Binding MonitoringStatus}" 
                           Foreground="LightGray" 
                           FontSize="8" 
                           VerticalAlignment="Center" 
                           HorizontalAlignment="Center"/>
                
                <Button Grid.Column="2" 
                        Content="ðŸ”„"
                        Command="{Binding RefreshCharactersCommand}"
                        Style="{StaticResource InfoIconButton}"
                        Width="16" Height="16"
                        FontSize="8"
                        ToolTip="Refresh"/>
            </Grid>
        </Border>
    </Grid>
</Window>